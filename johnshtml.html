<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  </head>
  <body>
    <canvas id="myCanvas" width="1920" height="1080"></canvas>
    <script>
    var canvas = document.getElementById('myCanvas');
    var context = canvas.getContext('2d');
    var myWidth = 0, myHeight = 0;
    var group1;
    var shiftedPoints;
    var referenceShiftX = canvas.width/10;
    var referenceShiftY = canvas.height/10;
    $.getJSON("/coordinates?base=0", function(data) {
        group1 = data;
       // var point1=[1,3];
       // var point2=[5, 2];
        //var point3=[7,4];
        //var point4=[10,1];
        //var point5=[12,10];
        //var allPoints=[point1, point2, point3, point4, point5];
        //var user2=[[1,5],[5,19],[7,15],[10,10],[12,15]];
        initializeWhole();
    })

    window.onresize=function(){
      reinitializeWhole();
    }
    function initializeWhole(){
        //Initializes 
        if( typeof( window.innerWidth ) == 'number' ) {
        //Non-IE
        myWidth = window.innerWidth;
        myHeight = window.innerHeight;
        } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
            //IE 6+ in 'standards compliant mode'
            myWidth = document.documentElement.clientWidth;
            myHeight = document.documentElement.clientHeight;
        } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
            //IE 4 compatible
            myWidth = document.body.clientWidth;
            myHeight = document.body.clientHeight;
        }
        canvas.width = myWidth;
        myHeight -= 5;
        canvas.height = myHeight;
        initializeAxis(myHeight, myWidth);
        renderGroup(group1);
        renderUser();
      }
      function reinitializeWhole(){
          if( typeof( window.innerWidth ) == 'number' ) {
            //Non-IE
            myWidth = window.innerWidth;
            myHeight = window.innerHeight;
        } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
            //IE 6+ in 'standards compliant mode'
            myWidth = document.documentElement.clientWidth;
            myHeight = document.documentElement.clientHeight;
        } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
            //IE 4 compatible
            myWidth = document.body.clientWidth;
            myHeight = document.body.clientHeight;
        }
        canvas.width = myWidth;
        myHeight -= 5;
        canvas.height = myHeight;
        initializeAxis(myHeight, myWidth);
        context.fillStyle = "#FFFFFF";
        context.fillRect(0,0,myWidth,myHeight);
        context.stroke();
        renderGroup(group1);
        renderUser();
      }
      function initializeAxis(screenHeight, screenWidth)
      {
            context.beginPath();
            context.moveTo(10, 0);
            context.quadraticCurveTo(10, screenHeight/2 , 10 , screenHeight);
            context.moveTo(10,screenHeight-2);
            context.quadraticCurveTo(screenWidth/2, screenHeight-2, screenWidth , screenHeight-2);
            context.lineWidth = 5;
            context.strokeStyle = 'black';
            context.stroke();
      }
      function calculatePath(point1, point2, lineWidth){
      tempPoint1 = [point1[0], point1[1]];
      tempPoint1[0] -= 3;
      context.beginPath();
      context.moveTo(tempPoint1[0], point1[1]);
      var midpoint = (tempPoint1[0]+point2[0])/2;
            if (point1[1] == point2[1])
            {
                context.quadraticCurveTo(midpoint,point1[1],point2[0],point2[1]);
            }
            else if (tempPoint1[0] == point2[0])
            {
                context.quadraticCurveTo(midpoint,(point1[1]+point2[1])/2,point2[0],point2[1]);
            }
            else //(point1[1] < point2[1])
            {
                context.quadraticCurveTo(midpoint,point1[1],point2[0],point2[1]);
            }
      context.lineWidth = lineWidth;
      context.strokeStyle = 'black';
      context.stroke();
      }
      function renderSet(shifted)
      {
        var i = 0;
        for (i = 1; i < shifted.length; i++)
        {
            calculatePath(shifted[i-1], shifted[i], 5);
            context.beginPath();
            //context.arc(shifted[i][0],shifted[i][1], 0, 2 * Math.PI, false);
            //context.fillStyle = 'black';
            //context.fill();
            //context.stroke();  //dot calculation
        }
      }
      function shiftPoints(allPoints, scale)
      {
        shiftedPoints = [];
        for(var i = 0; i < allPoints.length; i++)
        {
            var x = allPoints[i][0] * scale;
            var y = allPoints[i][1] * scale;
            shiftedPoints.push( [x,y] );
        }
      }
      function renderUser()
      {
        var newSet = [ [10 , myHeight-20], [myWidth - 20, myHeight-20]];
        calculatePath(newSet[0], newSet[1], 5);
        //arrow calculating
        calculatePath([newSet[1][0]+3,newSet[1][1]], [newSet[1][0]-10,newSet[1][1]-10], 5);
        calculatePath([newSet[1][0]+3,newSet[1][1]], [newSet[1][0]-10,newSet[1][1]+10], 5);
      }
      function renderGroup(group)
      {
        for(var i = 0; i < group.length; i++)
        {
            shiftPoints(group[i], canvas.width/40);
            renderSet(shiftedPoints);
        }
      }

    </script>
  </body>
</html>